@model IEnumerable<Ecommerce.Models.ProductModel>
@using Ecommerce.Database;


@{
    var quantity = Cart.quantity;
    ViewData["Title"] = "CartList";
    float total = 0;
}

<h1 style="text-align : center">Cart List</h1>

<table class="table">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.ProductName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ProductDescription)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ProductPrice)
            </th>
            <th>
                @Html.DisplayName("Quantity")
            </th>
            <th>
                @Html.DisplayName("Total")
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.ProductName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ProductDescription)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ProductPrice)
            </td>
            <td>
                @Html.DisplayName(quantity[item.ProductId].ToString())
            </td>
            <td>
                    @{
                        total = total + ((float)quantity[item.ProductId] * (float)item.ProductPrice);
                        @Html.DisplayName(((quantity[item.ProductId] * item.ProductPrice).ToString()))
                    }
            </td>
            <td>
                    @Html.ActionLink("Edit", "AddedToCart", new {ProductId = item.ProductId }, new { @class = "btn btn-secondary", @style = "padding : 0px 2px"})
                    <span style="margin-right: 15px"></span>
                    @Html.ActionLink("Remove", "RemoveItem", new { ProductId = item.ProductId }, new { @class = "btn btn-danger", onclick = "return confirm('Are you sure you want to remove this item?');", @style = "padding : 0px 2px" })

            </td>
        </tr>
}
    </tbody>
    <tbody>
        @if(total > 0)
        {
            int discount = 0;
            if (total >= 10000)
                discount = 25;
            else if (total >= 5000)
                discount = 20;
            else if (total >= 2000)
                discount = 20;
            else if(total >= 500)
                discount = 10;
            total = total - (total * discount) / 100;
            @if(discount > 0)
            {
                <tr>
                    <td style="text-align: right; padding-right : 20px; border : none" colspan="5">Discount - @discount%</td>
                </tr>
            }
            <tr>
                <td style="text-align: right; padding-right : 40px; border : none" colspan="5">Total - @total</td>
            </tr>
        }
    </tbody>
</table>
